# 護理排班系統 - 功能驗證清單

## ✅ 已完成的新功能

### 1. 設定頁面 (`/settings`)
- [ ] 訪問 http://localhost:3000/settings
- [ ] 設定病房名稱（例如：婦癌病房）
- [ ] 設定病床總數（預設50床）
- [ ] 設定護病比（預設 1:8）
- [ ] 查看自動計算的每班最低護理師需求（50床÷8=6.25→7人）
- [ ] 儲存設定並確認成功訊息

### 2. 首頁導航更新
- [ ] 確認首頁有「設定」按鈕（紫色）
- [ ] 可以從首頁導航到設定頁面

### 3. 三班模式改進
- [ ] 三欄並排顯示（日班、小夜班、大夜班）
- [ ] 所有人員在三班都顯示（對齊）
- [ ] 不能上大夜班的人員顯示為灰暗禁用狀態
- [ ] 同步捲動功能（預設開啟）
- [ ] 重複選人警告（紅色提示）

### 4. 假期優先模式改進
- [ ] 兩種排班模式選擇：
  - 特定護理師排班
  - 全系統自動排班
- [ ] 全自動排班的優先辦法：
  - 固定班別優先
  - 花班輪調
- [ ] 遵守護病比規定
- [ ] 每班至少一位N2+人員
- [ ] 24小時間隔保護
- [ ] 月休8天計算

### 5. 資料庫更新
- [ ] Ward 資料表新增 nursePatientRatio 欄位
- [ ] 預設值：護病比 1:8，病床50床

## 🧪 測試步驟

### 設定頁面測試
1. 進入首頁 http://localhost:3000
2. 點擊「設定」按鈠
3. 修改病房名稱為「測試病房」
4. 修改病床數為 40
5. 修改護病比為 1:10
6. 確認每班需求顯示為 4 人
7. 點擊「儲存設定」
8. 確認出現綠色成功訊息

### 三班模式測試
1. 進入「班表管理」
2. 選擇「三班模式排班」
3. 確認三欄並排顯示
4. 勾選「同步捲動」
5. 在日班欄位捲動，確認小夜班、大夜班同步捲動
6. 選擇孕婦護理師
7. 確認在大夜班欄位該護理師顯示為灰色且無法核取
8. 嘗試重複選擇同一護理師在兩個班別
9. 確認出現紅色警告

### 假期優先模式測試
1. 進入「班表管理」
2. 選擇「假期優先排班模式」
3. 選擇「全系統自動排班」
4. 選擇「固定班別優先」
5. 點擊「開始全自動排班」
6. 確認結果顯示：
   - 總計班表數
   - 已安排護理師人數
   - 平均每人工時
   - N2+人員配置狀態

## 📋 功能說明

### 護病比計算邏輯
```
每班最低護理師 = ceil(病床總數 / 護病比)

例如：
- 50床 ÷ 8 = 6.25 → 7人（向上取整）
- 40床 ÷ 10 = 4人
```

### 自動排班考量因素
1. **護病比**：每班至少達到設定的人數
2. **N2+要求**：每班至少一位N2(含)以上資深護理師
3. **24小時間隔**：同一人相鄰班次間隔24小時
4. **月休8天**：盡量滿足每人月休8天（有特休者可超過）
5. **勞動法規**：七休一、連續工作天數等
6. **特殊狀態**：孕婦/哺乳自動排除大夜班

### 排班模式說明

**固定班別優先**
- 盡量讓每人固定在日班、小夜班或大夜班
- 減少班別調動，維持工作節奏穩定
- 適合有明確班別偏好的人員配置

**花班輪調**
- 每人輪流上不同班別
- 均衡分配日夜班工作量
- 適合需要公平輪班的工作環境

## 🎯 下一步建議

1. **手動排班整合**：確保三班模式和假期優先模式的排班結果都能在手動排班頁面顯示和編輯
2. **護病比驗證**：在排班結果中顯示每班實際人數與護病比要求的對比
3. **報表功能**：導出排班報表，顯示護病比達成率

## 🐛 已知限制

1. 設定頁面目前只支援單一病房
2. 護病比計算為理論值，實際排班可能因人力不足無法完全達成
3. 需要足夠的活躍護理師才能滿足護病比要求（50床需要至少7人×3班=21人次/天）
